<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Spring中BeanFactory和FactoryBean的区别以及使用场景 - 飞狐的部落格</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Rosen Lu" /><meta name="description" content="简要叙述Spring中BeanFactory和FactoryBean的区别以及使用场景" /><meta name="keywords" content="Spring,BeanFactory,FactoryBean,区别,使用场景" />
<meta name="generator" content="Hugo0.126.1with theme even" />


<link rel="canonical" href="https://lucumt.info/post/spring/spring-core/difference-between-factorybean-and-beanfactory/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.f8a15eb0c012e3545d8b6ed47dcb94694059de6131ffb16c8bf6a65b3af1bf61.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet"><meta property="og:url" content="https://lucumt.info/post/spring/spring-core/difference-between-factorybean-and-beanfactory/">
  <meta property="og:site_name" content="飞狐的部落格">
  <meta property="og:title" content="Spring中BeanFactory和FactoryBean的区别以及使用场景">
  <meta property="og:description" content="简要叙述Spring中BeanFactory和FactoryBean的区别以及使用场景">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2022-01-16T11:00:01+08:00">
    <meta property="article:modified_time" content="2022-01-16T11:00:01+08:00">
    <meta property="article:tag" content="Spring">

  <meta itemprop="name" content="Spring中BeanFactory和FactoryBean的区别以及使用场景">
  <meta itemprop="description" content="简要叙述Spring中BeanFactory和FactoryBean的区别以及使用场景">
  <meta itemprop="datePublished" content="2022-01-16T11:00:01+08:00">
  <meta itemprop="dateModified" content="2022-01-16T11:00:01+08:00">
  <meta itemprop="wordCount" content="3208">
  <meta itemprop="keywords" content="Spring,BeanFactory,FactoryBean,区别,使用场景">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Spring中BeanFactory和FactoryBean的区别以及使用场景">
  <meta name="twitter:description" content="简要叙述Spring中BeanFactory和FactoryBean的区别以及使用场景">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]--><link href="/lib/prism-1.29.0/themes/prism-solarizedlight.min.css" rel="stylesheet">
<link href="/lib/prism-1.29.0/plugins/line-highlight/prism-line-highlight.min.css" rel="stylesheet">
<link href="/lib/prism-1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
</head>
<body>
	  
	  <a href="https://github.com/lucumt/ghblog" title="https://github.com/lucumt/ghblog" target="_blank">  
	  <img style="position: fixed; top: 0; right: 0; border: 0; z-index:9999;" 
		 src="/blog_img/forkme_right_gray.png" 
		 alt="Fork me on GitHub">
	  </a><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Rosen&#39;s World</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">主页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于我</li>
      </a><a href="https://tech.lucumt.info">
        <li class="mobile-menu-item">外链</li>
      </a><a href="/search/">
        <li class="mobile-menu-item">搜索</li>
      </a>
  </ul>

  


</nav>
<div class="container" id="mobile-panel"><header id="header" class="header"><div class="logo-wrapper">
  <a href="/" class="logo">Rosen&#39;s World</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">主页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于我</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://tech.lucumt.info">外链</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/search/">搜索</a>
      </li>
  </ul>
</nav>

    </header><main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Spring中BeanFactory和FactoryBean的区别以及使用场景</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-16 </span>
        <div class="post-category">
            <a href="/categories/spring%E7%B3%BB%E5%88%97/"> Spring系列 </a>
            </div>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#组件说明">组件说明</a>
          <ul>
            <li><a href="#beanfactory">BeanFactory</a></li>
            <li><a href="#factorybean">FactoryBean</a></li>
            <li><a href="#使用示例">使用示例</a></li>
          </ul>
        </li>
        <li><a href="#二者之间的区别">二者之间的区别</a></li>
        <li><a href="#相关使用场景">相关使用场景</a></li>
        <li><a href="#参考文档">参考文档</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
	 
	  	
	
    <div class="post-content image-border">
	 <p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/BeanFactory.html"><strong>BeanFactory</strong></a>和<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/FactoryBean.html"><strong>FactoryBean</strong></a>的区别与使用场景是<a href="https://spring.io/"><strong>Spring</strong></a>面试中的高频题之一，本文基于网上资料和个人理解，简要说明他们之间的异同以及使用场景。</p>
<h2 id="组件说明">组件说明</h2>
<h3 id="beanfactory">BeanFactory</h3>
<p>在<code>BeanFactory</code>的API中，一开始就有如下一句描述</p>
<blockquote>
<p>The root interface for accessing a Spring bean container</p>
</blockquote>
<p>这句话指明了<code>BeanFactory</code>在<code>Spring</code>家族中的地位，它是<strong>操作<code>Spring</code>容器、获取<code>Spring</code> Bean的根接口</strong>。从字面意思可以看出它是一个Bean工厂，其内部采用了工厂模式，通过它们我们可进行创建Bean、获取Bean等操作<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>。</p>
<p>在学习与使用<code>Spring</code>过程中接触到的<code>ApplicaitonContext</code>、<code>AnnotationConfigApplicastionContext</code>、<code>ClassPathXmlApplicationContext</code>等都是其子接口和具体的实现类，它是我们在<code>Spring</code>框架中接触最多的系统接口，下图中的UML展示了<code>BeanFactory</code>及其子接口和实现类之间的关系<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
<p><img src="/blog_img/spring/difference-between-factorybean-and-beanfactory/bean-factory-uml-1.png" alt="BeanFactory UML类图" title="BeanFactory UML类图"></p>
<p>下述代码展示了<code>BeanFactory</code>所包含的全部15个接口方法，它们涵盖了<code>Spring</code>中对Bean对象的各种读取操作，若经常使用<code>Spring</code>这些接口方法看起来就会很熟悉。</p>
<details>
  <summary><mark><font color=darkred>BeanFactory接口(点击可展开)</font></mark></summary>
<pre class="line-numbers language-java " title="java">
<code>public interface BeanFactory {

	String FACTORY_BEAN_PREFIX = &#34;&amp;&#34;;
    
	Object getBean(String name) throws BeansException;

	&lt;T&gt; T getBean(String name, Class&lt;T&gt; requiredType) throws BeansException;

	Object getBean(String name, Object... args) throws BeansException;

	&lt;T&gt; T getBean(Class&lt;T&gt; requiredType) throws BeansException;

	&lt;T&gt; T getBean(Class&lt;T&gt; requiredType, Object... args) throws BeansException;

	&lt;T&gt; ObjectProvider&lt;T&gt; getBeanProvider(Class&lt;T&gt; requiredType);

	&lt;T&gt; ObjectProvider&lt;T&gt; getBeanProvider(ResolvableType requiredType);

	boolean containsBean(String name);

	boolean isSingleton(String name) throws NoSuchBeanDefinitionException;
    
	boolean isPrototype(String name) throws NoSuchBeanDefinitionException;
    
	boolean isTypeMatch(String name, ResolvableType typeToMatch) throws NoSuchBeanDefinitionException;

	boolean isTypeMatch(String name, Class&lt;?&gt; typeToMatch) throws NoSuchBeanDefinitionException;

	@Nullable
	Class&lt;?&gt; getType(String name) throws NoSuchBeanDefinitionException;
        
	@Nullable
	Class&lt;?&gt; getType(String name, boolean allowFactoryBeanInit) throws NoSuchBeanDefinitionException;

	String[] getAliases(String name);
}</code>
</pre></details>
<p>由于<code>BeanFactory</code>是操作<code>Spring</code>容器和对象的根接口，<code>Spring</code>官方要求它尽可能的支持Bean生命周期的各种接口，基于<code>Spring</code>官方API的描述，其完整的方法链和顺序如下：</p>
<ol>
<li>BeanNameAware&rsquo;s <code>setBeanName</code></li>
<li>BeanClassLoaderAware&rsquo;s <code>setBeanClassLoader</code></li>
<li>BeanFactoryAware&rsquo;s <code>setBeanFactory</code></li>
<li>EnvironmentAware&rsquo;s <code>setEnvironment</code></li>
<li>EmbeddedValueResolverAware&rsquo;s <code>setEmbeddedValueResolver</code></li>
<li>ResourceLoaderAware&rsquo;s <code>setResourceLoader</code> (only applicable when running in an application context)</li>
<li>ApplicationEventPublisherAware&rsquo;s <code>setApplicationEventPublisher</code> (only applicable when running in an application context)</li>
<li>MessageSourceAware&rsquo;s <code>setMessageSource</code> (only applicable when running in an application context)</li>
<li>ApplicationContextAware&rsquo;s <code>setApplicationContext</code> (only applicable when running in an application context)</li>
<li>ServletContextAware&rsquo;s <code>setServletContext</code> (only applicable when running in a web application context)</li>
<li><code>postProcessBeforeInitialization</code> methods of BeanPostProcessors</li>
<li>InitializingBean&rsquo;s <code>afterPropertiesSet</code></li>
<li>a custom <code>init-method</code> definition</li>
<li><code>postProcessAfterInitialization</code> methods of BeanPostProcessors</li>
</ol>
<p>上述初始化链可很好的帮我们回答面试中另外几个常见的问题：</p>
<ul>
<li><code>Spring</code>中Bean如何初始化</li>
<li>描述<code>Spring</code>中Bean的生命周期</li>
</ul>
<h3 id="factorybean">FactoryBean</h3>
<p><code>FactoryBean</code>从名字就能看出来是一个Bean，但不是普通的Bean，否则<code>Spring</code>作者为啥要单独的创建这个接口呢？<code>FactoryBean</code>也是一个接口，其源码如下，从中可以看出该接口只有3个方法，与<code>BeanFactory</code>相比数量大为减少，同时这3个接口方法的作用也同<code>BeanFactory</code>中的相关方法类似。</p>
<pre class="line-numbers language-java " title="java">
<code>public interface FactoryBean&lt;T&gt; {

	String OBJECT_TYPE_ATTRIBUTE = &#34;factoryBeanObjectType&#34;;

	@Nullable
	T getObject() throws Exception;

	@Nullable
	Class&lt;?&gt; getObjectType();

	default boolean isSingleton() {
		return true;
	}

}</code>
</pre><p>通过上述代码能够获取的信息依旧有限，在<code>FactoryBean</code>的官方API中有如下描述</p>
<blockquote>
<p>Interface to be implemented by objects used within a <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/BeanFactory.html"><code>BeanFactory</code></a> which are themselves factories for individual objects. If a bean implements this interface, it is used as a factory for an object to expose, not directly as a bean instance that will be exposed itself.</p>
<p><strong>NB: A bean that implements this interface cannot be used as a normal bean.</strong> A FactoryBean is defined in a bean style, but the object exposed for bean references (<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/FactoryBean.html#getObject--"><code>getObject()</code></a>) is always the object that it creates.</p>
</blockquote>
<p>上述文档的主要结论如下：</p>
<ul>
<li><code>FactoryBean</code>不是一个普通的Bean，它实际上是一个用于创建特定bean的工厂</li>
<li>通过实现<code>FactoryBean</code>接口，可通过暴露对象的方式创建特定bean对象，而这个bean对象本身不会暴露</li>
</ul>
<p>到这里虽然二者的区别清楚了，但是<code>FactoryBean</code>的使用场景还是不清晰，在<a href="https://spring.io/blog/2011/08/09/what-s-a-factorybean"><strong>https://spring.io/blog/2011/08/09/what-s-a-factorybean</strong></a>这篇文章中，<code>Spring</code>的作者之一<a href="https://spring.io/team/joshlong"><strong>JOSH LONG</strong></a>用如下文字阐述了<code>FactoryBean</code>的使用场景</p>
<blockquote>
<p>A <code>FactoryBean</code> is a pattern to encapsulate interesting object construction logic in a class. It might be used, for example, to encode the construction of a complex object graph in a reusable way. Often this is used to construct complex objects that have many dependencies. It might also be used when the construction logic itself is highly volatile and depends on the configuration. A <code>FactoryBean</code> is also useful to help Spring construct objects that it couldn’t easily construct itself.</p>
</blockquote>
<p>从上述文字中可以看出<code>FactoryBean</code>主要<strong>用于构建一些实例化过程较为复杂或有配置依赖的对象(即非普通POJO)，并将其交给<code>Spring</code>容器管理</strong>。</p>
<p><code>Spring</code>框架本身就自带了实现<code>FactoryBean</code>的70多个接口，如<code>ProxyFactoryBean</code>、<code>MapFactoryBean</code>、<code>PropertiesFactoryBean</code>等，从个人角度来看它们要么理解起来较为复杂，要么使用较少不具有代表性，下面以<code>MyBatis-Spring</code>中的<a href="https://github.com/mybatis/spring/blob/master/src/main/java/org/mybatis/spring/SqlSessionFactoryBean.java"><strong>SqlSessionFactoryBean</strong></a>为例来了解其用法</p>
<pre class="line-numbers language-java " title="java">
<code>  @Override
  public SqlSessionFactory getObject() throws Exception {
    if (this.sqlSessionFactory == null) {
      afterPropertiesSet();
    }

    return this.sqlSessionFactory;
  }

  // 参数校验与对象创建
  public void afterPropertiesSet() throws Exception {
    notNull(dataSource, &#34;Property &#39;dataSource&#39; is required&#34;);
    notNull(sqlSessionFactoryBuilder, &#34;Property &#39;sqlSessionFactoryBuilder&#39; is required&#34;);
    state((configuration == null &amp;&amp; configLocation == null) || !(configuration != null &amp;&amp; configLocation != null),
        &#34;Property &#39;configuration&#39; and &#39;configLocation&#39; can not specified with together&#34;);

    this.sqlSessionFactory = buildSqlSessionFactory();
  }

// 基于配置文件创建具体的SqlSessionFactory
protected SqlSessionFactory buildSqlSessionFactory() throws Exception {
    // 各种检查代码
    
    return this.sqlSessionFactoryBuilder.build(targetConfiguration);
}</code>
</pre><p>在创建<code>SqlSessionFactory</code>时需要依赖数据库的配置等一些配置信息，但这些配置信息若通过<code>BeanFactory</code>以传统的<strong>实例化</strong>-&gt;<strong>初始化</strong>的方式创建时是很难办到的，虽然可以通过<code>BeanPostProcessors</code>的接口中的回调方法来实现，但会导致代码复杂并且不能满足某些特殊场景下的需求，而通过<code>FactoryBean</code>我们只需要根据实际业务逻辑在<code>getObject()</code>方法中创建对应的对象并返回即可，由于对象的创建由我们自己把控，在达到代码简洁的同时，创建的对象也能被<code>Spring</code>容器管理。</p>
<h3 id="使用示例">使用示例</h3>
<p>假设有如下所示的Group类</p>
<pre class="line-numbers language-java " title="java">
<code>@Service
public class Group {

    private String groupName;

    // getter setter
}</code>
</pre><p>在使用<code>BeanFactory</code>获取对象的方法如下</p>
<pre class="line-numbers language-java " title="java">
<code>public static void main(String[] args) {
    AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
    Group group = context.getBean(Group.class);
    System.out.println(group.hashCode());
}</code>
</pre><p>输出结果为Group@25d250c6，可以看到已经正确的获取到了Bean对象。</p>
<p>定义一个实现了<code>FactoryBean</code>接口的GroupFactoryBean，其代码如下：</p>
<pre class="line-numbers language-java " title="java">
<code>public class GroupFactoryBean implements FactoryBean&lt;Group&gt; {


    @Override
    public Group getObject() throws Exception {
        return new Group();
    }

    @Override
    public Class&lt;?&gt; getObjectType() {
        return Group.class;
    }
}</code>
</pre><p>测试代码如下：</p>
<pre class="line-numbers language-java " title="java">
<code>public static void main(String[] args) {
    AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(GroupFactoryBean.class);
    Object object = context.getBean(&#34;groupFactoryBean&#34;);
    System.out.println(object);
}</code>
</pre><p>输出结果为Group@fdefd3f，如前面通过<code>BeanFactory</code> 创建的对象类似，接下来将<strong>groupFactoryBean</strong>添加一个<code>&amp;</code>前缀，变为<code>&amp;groupFactoryBean</code>后再次进行测试</p>
<pre class="line-numbers language-java " title="java">
<code>public static void main(String[] args) {
    AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(GroupFactoryBean.class);
    Object object = context.getBean(&#34;&amp;groupFactoryBean&#34;);
    System.out.println(object);
}</code>
</pre><p>输出结果为GroupFactoryBean@1990a65e，由此可得出如下结论 ：</p>
<ul>
<li>当直接通过<code>FactoryBean</code>实现类的接口名称获取对象时，得到的是该<code>FactoryBean</code>实现类中创建的对象本身，也是我们正常的使用方式</li>
<li>当在<code>FactoryBean</code>接口对象名前面加上<code>&amp;</code>前缀时，得到的是<code>FactoryBean</code>实现类本身，一般用于调试分析。</li>
</ul>
<h2 id="二者之间的区别">二者之间的区别</h2>
<ul>
<li>相同点：
<ul>
<li>都是接口类，需要使用者自己实现相应的方法</li>
<li>接口中创建bean对象都能被<code>Spring</code>容器管理</li>
</ul>
</li>
<li>不同点:
<ul>
<li><code>BeanFactory</code>提供的接口方法更多，更具有灵活性，如能获取别名、bean对象类型等</li>
<li><code>BeanFactory</code>基于<code>Spring</code>规范实现，其创建的bean会在<code>Spring</code>容器中经历完整的生命周期，能够调用<code>@PostConstruct</code>、<code>BeanPostProcessors</code>等接口和方法</li>
<li><code>Spring</code>容器只负责<code>FactoryBean</code>创建的bean对象的生命周期管理，不负责bean对象的创建和销毁(因为由我们自己实现了嘛!)，所以调用<code>@PostConstruct</code>和<code>@PreDestroy</code>方法不会生效，需要实现<code>DisposableBean</code>等接口来达到该目的</li>
</ul>
</li>
</ul>
<h2 id="相关使用场景">相关使用场景</h2>
<ul>
<li><strong><code>BeanFactory</code></strong>:
<ul>
<li>项目中各种常规的<code>POJO</code>、<code>Dao</code>、<code>Service</code>等不涉及复杂构造的场景</li>
</ul>
</li>
<li><strong><code>FactoryBean</code></strong>:
<ul>
<li>对象的构造(实例化)较为复杂，通常是系统中的一些底层组件，如<code>SqlSessionFactoryBean</code>、<code>ProxyFactoryBean</code>等</li>
</ul>
</li>
</ul>
<h2 id="参考文档">参考文档</h2>
<ul>
<li>
<p><a href="https://www.cnblogs.com/aspirant/p/9082858.html">https://www.cnblogs.com/aspirant/p/9082858.html</a></p>
</li>
<li>
<p><a href="https://spring.io/blog/2011/08/09/what-s-a-factorybean">https://spring.io/blog/2011/08/09/what-s-a-factorybean</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/FactoryBean.html">https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/FactoryBean.html</a></p>
</li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>实际上Bean的创建、销毁都是由容器来负责的，使用时更多关注的是Bean对象的配置以及如何获取Bean对象&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>出于篇幅的考虑，实际上这张UML类图展示的并不完整，可在IDEA中基于<code>BeanFactory</code>自己生成完整的UML图&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/spring/">Spring</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/web/convert-folder-upload-data-to-tree-node-in-chrome/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">在Chrome中将上传的文件夹数据转化为按树结构展示</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/mysql/how-to-deal-with-deadlocks-in-mysql/">
            <span class="next-text nav-default">[译]如何处理MySQL中的死锁</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

      </div>
    </main>
	<footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:cumtlu@126.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/users/3176419" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://www.linkedin.com/in/%E8%BF%90%E5%BC%BA-%E5%8D%A2-50a08bb5/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://github.com/lucumt" class="iconfont icon-github" title="github"></a>
  <a href="" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2016 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer><div class="back-to-top" id="back-to-top" title="回到顶部">
      <i class="iconfont icon-up"></i>
    </div>
  </div><script type="text/javascript" src="/lib/jquery/jquery-3.6.4.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script><script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script><script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7546563545653680"
            crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-75123653-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-75123653-1');
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-3S3FFW5PH3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3S3FFW5PH3');
</script><script id="baidu_analytics">
	  var _hmt = _hmt || [];
	  (function() {
		if (window.location.hostname === 'localhost') return;
		var hm = document.createElement("script"); hm.async = true;
		hm.src = "https://hm.baidu.com/hm.js?cabc0a71f63da092412d82d1aefe7d1c";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hm, s);
	  })();
	</script>


	<script id="baidu_push">
	  (function(){
		if (window.location.hostname === 'localhost') return;
		var bp = document.createElement('script'); bp.async = true;
		var curProtocol = window.location.protocol.split(':')[0];
		if (curProtocol === 'https') {
		  bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
		}
		else {
		  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
		}
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(bp, s);
	  })();
	</script>


<script>
  let copyIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
  <path fill-rule="evenodd" 
  d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 
      5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"/>
</svg>`;
  let copiedIcon=`<svg clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
  <path d="m2.25 12.321 7.27 6.491c.143.127.321.19.499.19.206 0 .41-.084.559-.249l11.23-12.501c.129-.143.192-.321.192-.5 0-.419-.338-.75-.749-.75-.206 0-.411.084-.559.249l-10.731 11.945-6.711-5.994c-.144-.127-.322-.19-.5-.19-.417 0-.75.336-.75.749 0 .206.084.412.25.56" fill-rule="nonzero"/></svg>`;
  function createCopyButton(codeDiv) {
    const div = document.createElement("div");
    div.className = "copy-code";
    div.innerHTML = copyIcon;
    div.addEventListener("click", () =>
      copyCodeToClipboard(div, codeDiv)
    );
    addCopyButtonToDom(div, codeDiv);
  }

  async function copyCodeToClipboard(button, codeDiv) {
    const codeToCopy = codeDiv.querySelector(":scope > code")
      .innerText;
    await navigator.clipboard.writeText(codeToCopy);
    button.blur();
	button.innerHTML = copiedIcon;
    setTimeout(() => button.innerHTML = copyIcon, 2000);
  }

  function addCopyButtonToDom(button, codeDiv) {
    const wrapper = document.createElement("div");
    wrapper.className = "highlight-wrapper";
    codeDiv.parentNode.insertBefore(wrapper, codeDiv);
    wrapper.appendChild(codeDiv);
	wrapper.insertBefore(button, wrapper.firstChild);
  }

  var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
  if(!isMobile){
     document.querySelectorAll("pre[class*=language]").forEach((codeDiv) => createCopyButton(codeDiv));
  }
</script>  




  <script type="text/javascript" src="/lib/prism-1.29.0/components/prism-core.min.js"></script>
  <script type="text/javascript" src="/lib/prism-1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script type="text/javascript" src="/lib/prism-1.29.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
  <script type="text/javascript" src="/lib/prism-1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
  
  <script type="text/javascript">
     document.addEventListener('DOMContentLoaded', initCodeTabs);
	 document.addEventListener('DOMContentLoaded', switchTabCodes);
	 function initCodeTabs(){
	     document.querySelectorAll('.codetabs').forEach(tab =>{
		    let tabHeader = tab.querySelector('.codetabs-header');
			let tabBody = tab.querySelector('.codetabs-body');
		    let codeblocks = tab.querySelectorAll('.codetabs-body > .highlight-wrapper');
			codeblocks.forEach((block,index) =>{
			   let titleContent = block.querySelector('pre').getAttribute('title');
			   let title = document.createElement('div');
			   title.classList.add('tab');
			   if(index == 0){
			   	  title.classList.add('active');
			   }
			   title.setAttribute('data-codetab',index);
			   title.appendChild(document.createTextNode(titleContent));
			   tabHeader.appendChild(title);
			   
			   let div = document.createElement('div');
			   div.classList.add('tab');
			   if(index == 0){
			   	  div.classList.add('active');
			   }
			   div.setAttribute('data-codetab',index);
			   div.appendChild(block);
			   tabBody.appendChild(div);
			});
		 });
	 }
	 function switchTabCodes(){
		 document.querySelectorAll('.codetabs  .codetabs-header > .tab').forEach(tab => {
			 tab.addEventListener('click', function() {
			      if(tab.classList.contains('active')){
					 return;
				  }
				  let tabId = tab.getAttribute('data-codetab');
				  let codetabs = tab.parentNode.parentNode;
				  
				  codetabs.querySelectorAll('.codetabs .tab.active').forEach(e => e.classList.remove('active'));
				  codetabs.querySelectorAll('.codetabs .tab[data-codetab="' + tabId + '"]').forEach(e => e.classList.add('active'));  
			 });
		 });
	 }
  </script>
</body>
</html>
