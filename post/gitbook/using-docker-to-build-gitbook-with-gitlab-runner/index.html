<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>在Docker中构建GitBook并整合GitLab Runner的使用经验分享 - 飞狐的部落格</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Rosen Lu" /><meta name="description" content="简要介绍如何通过Docker创建GitBook并通过GitLab Runner实现GitBook文档内容的自动更新" /><meta name="keywords" content="docker, gitbook" />






<meta name="generator" content="Hugo 0.100.2 with theme even" />


<link rel="canonical" href="https://lucumt.info/post/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.f7f4d73c43a767e434997279164764c32c7f0f3b1ec88bfb5bfc297b77fd7e7a.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="在Docker中构建GitBook并整合GitLab Runner的使用经验分享" />
<meta property="og:description" content="简要介绍如何通过Docker创建GitBook并通过GitLab Runner实现GitBook文档内容的自动更新" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lucumt.info/post/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-10-07T10:14:02+08:00" />
<meta property="article:modified_time" content="2023-10-07T10:14:02+08:00" />

<meta itemprop="name" content="在Docker中构建GitBook并整合GitLab Runner的使用经验分享">
<meta itemprop="description" content="简要介绍如何通过Docker创建GitBook并通过GitLab Runner实现GitBook文档内容的自动更新"><meta itemprop="datePublished" content="2023-10-07T10:14:02+08:00" />
<meta itemprop="dateModified" content="2023-10-07T10:14:02+08:00" />
<meta itemprop="wordCount" content="6438">
<meta itemprop="keywords" content="gitbook,docker,gitlab-runner," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="在Docker中构建GitBook并整合GitLab Runner的使用经验分享"/>
<meta name="twitter:description" content="简要介绍如何通过Docker创建GitBook并通过GitLab Runner实现GitBook文档内容的自动更新"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>

  
	  
	  
	  <a href="https://github.com/lucumt/ghblog" title="https://github.com/lucumt/ghblog" target="_blank">  
	  <img style="position: fixed; top: 0; right: 0; border: 0; z-index:9999;" 
		 src="/blog_img/forkme_right_gray.png" 
		 alt="Fork me on GitHub">
	  </a>
  


  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Rosen&#39;s World</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">主页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于我</li>
      </a><a href="/links/">
        <li class="mobile-menu-item">外链</li>
      </a><a href="/search/">
        <li class="mobile-menu-item">搜索</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Rosen&#39;s World</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">主页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于我</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/links/">外链</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/search/">搜索</a>
      </li>
  </ul>
</nav>

    </header>

    
    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">在Docker中构建GitBook并整合GitLab Runner的使用经验分享</h1>

      <div class="post-meta">
        <span class="post-time"> 2023-10-07 </span>
        <div class="post-category">
            <a href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"> 工具使用 </a>
            <a href="/categories/%E5%AE%B9%E5%99%A8%E5%8C%96/"> 容器化 </a>
            </div>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#背景">背景</a>
      <ul>
        <li><a href="#技术选型">技术选型</a></li>
        <li><a href="#使用流程">使用流程</a></li>
      </ul>
    </li>
    <li><a href="#环境搭建">环境搭建</a>
      <ul>
        <li><a href="#相关说明">相关说明</a></li>
        <li><a href="#操作流程">操作流程</a></li>
        <li><a href="#测试验证">测试验证</a>
          <ul>
            <li><a href="#自动构建">自动构建</a></li>
            <li><a href="#手工构建">手工构建</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#插件管理">插件管理</a>
      <ul>
        <li><a href="#常用插件">常用插件</a></li>
        <li><a href="#自定义插件">自定义插件</a></li>
      </ul>
    </li>
    <li><a href="#其它设置">其它设置</a>
      <ul>
        <li><a href="#中文汉化">中文汉化</a></li>
        <li><a href="#自定义目录">自定义目录</a></li>
        <li><a href="#自定义样式">自定义样式</a></li>
      </ul>
    </li>
    <li><a href="#使用展示">使用展示</a></li>
    <li><a href="#文件脚本">文件&amp;脚本</a>
      <ul>
        <li><a href="#dockerfile脚本">Dockerfile脚本</a></li>
        <li><a href="#docker启停脚本">docker启停脚本</a></li>
        <li><a href="#自动构建脚本">自动构建脚本</a></li>
        <li><a href="#自动注册脚本">自动注册脚本</a></li>
        <li><a href="#自动生成目录">自动生成目录</a></li>
        <li><a href="#自定义样式-1">自定义样式</a></li>
        <li><a href="#gitbook配置文件">GitBook配置文件</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
	 
	  	
	
    <div class="post-content image-border">
	 <p>由于<code>Docsify</code>采用单页渲染的方式，在初次打开是特别慢，近期将团队内部的知识库工具从<code>Docsify</code>迁移到基于<code>Docker</code>搭建的<code>GitBook</code>并结合<code>GitLab Runner</code>实现自动更新，在这其中踩了一些坑，简单记录下。</p>
<h1 id="背景">背景</h1>
<h2 id="技术选型">技术选型</h2>
<p>由于<code>Docsify</code>采用<a href="https://en.wikipedia.org/wiki/Single-page_application"><strong>SPA</strong></a>模式开发，不会生成静态<code>HTML</code>页面，故随着内容与页面的增多，其初次加载时会花费较多时间进行全局渲染，导致显示很慢，浪费时间等于谋财害命，需要将其替换为其它框架！</p>
<p>由于知识库的使用群体除了软件开发人员，还有产品设计师、测试工程师等不具备很强代码开发能力的群体，故在替换之前对要采用的新框架确定了如下目标：</p>
<ul>
<li>采用静态页面生成，避免每次浏览时都需要耗时渲染</li>
<li>采用纯<code>Markdown</code>语法，避免额外的学习与使用成本</li>
<li>界面美观，适合做文档展示，无须做过多配置</li>
<li>插件生态丰富，无须自己额外开发太多的插件</li>
</ul>
<p>基于网络上的资料，初步选定<code>Docsify</code>、<code>GitBook</code>、<code>Hexo</code>和<code>Hugo</code>这4种框架，基于实际使用需求对它们进行对比如下：</p>
<table>
<thead>
<tr>
<th></th>
<th>开发语言</th>
<th>构建速度</th>
<th>展示方式</th>
<th>格式要求</th>
<th>文档 / 社区</th>
<th>目录生成</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Docsify</strong></td>
<td><code>Vue</code></td>
<td>一般</td>
<td>单页面渲染</td>
<td>无</td>
<td>一般</td>
<td>可通过插件自动生成</td>
<td>环境安装简单</td>
<td>初次打开加载很慢</td>
</tr>
<tr>
<td><strong>GitBook</strong></td>
<td><code>Node.js</code></td>
<td>一般</td>
<td>静态页面</td>
<td>无</td>
<td>一般</td>
<td>需自己在<code>SUMMARY.md</code>中生成</td>
<td>样式美观，专门用于做文档管理</td>
<td>官方专注于付费版，非付费版bug较多</td>
</tr>
<tr>
<td><strong>Hexo</strong></td>
<td><code>Node.js</code></td>
<td>一般</td>
<td>静态页面</td>
<td>需添加日期、标题等信息</td>
<td>丰富</td>
<td>依赖于所选的主题</td>
<td>社区活跃，使用度很高</td>
<td>编译速度慢，主要适合做博客</td>
</tr>
<tr>
<td><strong>Hugo</strong></td>
<td><code>Golang</code></td>
<td>快</td>
<td>静态页面</td>
<td>需添加日期、标题等信息</td>
<td>丰富</td>
<td>依赖于所选的主题</td>
<td>构建速度快，使用度很高</td>
<td>文档不完善，主要适合做博客</td>
</tr>
</tbody>
</table>
<p>基于上述对比，可发现虽然<code>Hugo</code>的构建速度最快，但适合做博客，对于知识库这种文档系统不是特别合适，而<code>GitBook</code>虽然构建速度没有<code>Hugo</code>快，但<code>GitBook</code>更侧重于浏览，其构建只会在文档内容有更新时才发生，频率相对较小，同时<code>GitBook</code>从名字上即可看出是专门用于知识库文档管理的，综合考虑下决定采用<code>GitBook</code>来替换<code>Docsify</code>。</p>
<p>同时为了降低<code>GitBook</code>的侵入性，指定如下规则：</p>
<ol>
<li><code>GitLab Runner</code>和<code>Nginx</code>采用<code>Docker</code>进行容器化部署，避免对部署环境的强依赖</li>
<li>通过<code>Docker</code>在<code>GitLab Runner</code>中安装<code>GitBook</code>环境，使得实际的文档项目与<code>GitBook</code>解耦</li>
</ol>
<h2 id="使用流程">使用流程</h2>
<p>由于文档同代码一样都是采用<code>GitLab</code>管理的，为了实现在文档更新时能够自动化的部署，准备采用<code>GitLab Runner</code>+<code>GitBook</code>+<code>Nginx</code>的方案，整体流程图如下：</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-gitlab-usage-flow.png" alt="GitBook结合GitLab Runner使用流程" title="GitBook结合GitLab Runner使用流程"></p>
<p>在实际使用时，相关用户只需要在按照常规的流程在本地基于<code>Markdown</code>格式编写文档并提交到<code>GitLab</code>中，之后<code>GitLab Runner</code>会自动化的进行文档构建与文档生成，依赖于宿主物理机的配置和文档数量，整个过程通常不超过5秒钟，之后在浏览器中刷新即可查看生成的<code>HTML</code>静态文件。</p>
<h1 id="环境搭建">环境搭建</h1>
<h2 id="相关说明">相关说明</h2>
<p>出于简化使用流程与加快构建速度的考虑，将<code>GitLab Runner</code>与<code>GitBook</code>都放置到同一个容器中。在<code>GitLab Runner</code>的<code>Docker</code>容器中安装完毕<code>GitBook</code>环境后，还需将<code>GitLab Runner</code>注册到对应的<code>GitLab</code>仓库中，可通过<code>Shell</code>脚本将此过程固化下来，整个环境搭建流程如下：</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-install-flow.png" alt="GitBook安装流程" title="GitBook安装"></p>
<p><strong>说明</strong>：由于<code>GitBook</code>是基于<code>Nodejs</code>开发的，而<code>Nodejs</code>和<code>NPM</code>对版本有强相关的依赖，版本过高或过低都会导致<code>GitBook</code>以及相关的插件无法安装，故本次采用了如下<strong>较旧的版本</strong>(采用<code>Docker</code>容器化部署不会造成额外的负面影响 )</p>
<table>
<thead>
<tr>
<th></th>
<th>版本</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GitLab Runner</strong></td>
<td><code>gitlab/gitlab-runner:v15.5.2</code></td>
<td></td>
</tr>
<tr>
<td><strong>GitBook Cli</strong></td>
<td><code>gitbook-cli@2.1.2</code></td>
<td>若版本不对，会导致依赖问题，请参见<a href="https://stackoverflow.com/questions/64211386/gitbook-cli-install-error-typeerror-cb-apply-is-not-a-function-inside-graceful"><strong>Gitbook-cli install error TypeError: cb.apply is not a function inside graceful-fs</strong></a></td>
</tr>
<tr>
<td><strong>GitBook</strong></td>
<td><code>3.2.3</code></td>
<td></td>
</tr>
<tr>
<td><strong>Nodejs</strong></td>
<td><code>v12.22.12</code></td>
<td></td>
</tr>
<tr>
<td><strong>NPM</strong></td>
<td><code>7.5.2</code></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="操作流程">操作流程</h2>
<p>下述步骤展示了从头开始构建<code>GitLab Runner</code>与<code>GitBook</code>的过程</p>
<ol>
<li>
<p>在宿主机上执行如下指令安装<a href="https://github.com/jqlang/jq"><strong>jq</strong></a>指令，后续会用其来解析<code>GitLab</code>中返回的<code>JSON</code>数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 在宿主机上安装jq，用于解析json文件</span>
</span></span><span class="line"><span class="cl">apt install -y jq
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>安装之前请仿照下图将本文最后的<a href="#%E6%96%87%E4%BB%B6%E8%84%9A%E6%9C%AC"><strong>文件&amp;脚本</strong></a></p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-build-file-folder.png" alt="GitBook镜像构建前准备" title="GitBook镜像构建前准备"></p>
</li>
<li>
<p>运行下述指令构建需要的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -t gitbook_custom:v1.0
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>Dockerfile</code>在构建过程中会对它认为没有变化的文件和日志输出进行缓存，要想查看全部日志并取消缓存，可用如下指令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -t gitbook_custom:v1.0  --progress string . --no-cache
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>执行下述指令启动<code>Docker</code>容器并执行相关的初始化操作</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose down <span class="o">&amp;&amp;</span> docker-compose up -d <span class="o">&amp;&amp;</span> bash gitlab_runner_config_init.sh
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>安装过程中会有类似如下输出:</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-install-output-1.png" alt="GitBook安装过程1" title="GitBook安装过程1"></p>
<p>若最后输出结果类似如下，则表示整个脚本安装过程顺利完成</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-install-output-2.png" alt="GitBook安装过程2" title="GitBook安装过程2"></p>
</li>
<li>
<p>在对应<code>GitLab</code>项目中依次点击<code>Settings</code>-&gt;<code>CI/CD</code>-&gt;<code>Runners</code>，若出现类似如下界面则表示<code>GitLab Runner</code>正确安装与配置完毕，接下来即可验证<code>GitBook</code>是否能正常工作</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitlab-runner-register-result.png" alt="GitLab Runner注册结果" title="GitLab Runner注册结果"></p>
</li>
</ol>
<h2 id="测试验证">测试验证</h2>
<h3 id="自动构建">自动构建</h3>
<p>由于<a href="#%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC"><strong>自动构建脚本</strong></a>中有如下配置，其中构建阶段的值被设置为<code>build</code>会导致每次代码发生变更时都执行自动构建</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">stages</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># build阶段执行的操作命令 </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">build</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>当我们通过<code>git push</code>将代码推送到<code>GitLab</code>后，在对应的<code>GitLab</code>工程中依次点击<code>CI/CD</code>-&gt;<code>Pipelines</code>，会有类似如下输出，可以看到此时<code>GitLab Runner</code>正在执行构建</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitlab-pipeline-running.png" alt="GitLab Runner正在执行" title="GitLab Runner正在执行"></p>
<p>点击对应的按钮可查看构建执行日志，类似如下：</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitlab-pipeline-running-log.png" alt="GitLab Runner执行日志结果" title="GitLab Runner执行日志结果"></p>
<p>之后可通过<code>Nginx</code>对应端口访问相应的<code>GitBook</code>页面，可参考<a href="#%E4%BD%BF%E7%94%A8%E5%B1%95%E7%A4%BA"><strong>使用展示</strong></a>。</p>
<h3 id="手工构建">手工构建</h3>
<p>除了自动构建之外，也可点击对应的按钮进行手工提交，此种场景一般用于文档代码没有变更而对<code>GitBook</code>的样式或插件进行了修改，想提前验证结果，操作步骤如下：</p>
<p>在对应的<code>GitLab</code>工程中依次点击<code>CI/CD</code>-&gt;<code>Pipelines</code>，在出现的菜单中点击右上角的<code>Run pipeline</code>按钮</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitlab-pipeline-run-button.png" alt="GitLab Runner手工触发" title="GitLab Runner手工触发"></p>
<p>在出现的界面中再次点击<code>Run pipeline</code>按钮进行确认，触发手工执行，之后的步骤与自动构建时相同。</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitlab-pipeline-run-confirm-button.png" alt="GitLab Runner手工触发确认" title="GitLab Runner手工触发确认"></p>
<h1 id="插件管理">插件管理</h1>
<p><code>GitBook</code>在文档管理领域广受欢迎的一个很重要的原因是其丰富的插件生态，插件可快速集成，也可仿照别人的插件根据自己的需求快速开发新的插件，个人项目中用到的插件如下</p>
<h2 id="常用插件">常用插件</h2>
<table>
<thead>
<tr>
<th>插件</th>
<th>作用</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/gitbook-plugin-fox/gitbook-plugin-prism-codetab-fox"><strong>gitbook-plugin-prism-codetab-fox</strong></a></td>
<td>对代码采用<a href="https://prismjs.com/"><strong>Prims.js</strong></a>进行高亮，同时可根据需求对代码进行分组</td>
<td>需要在<code>book.js</code>中通过 <code>-highlight</code>的方式屏蔽默认的高亮插件</td>
</tr>
<tr>
<td><a href="https://github.com/gitbook-plugin-fox/gitbook-plugin-mermaid-fox"><strong>gitbook-plugin-mermaid-fox</strong></a></td>
<td>支持<a href="https://mermaid.js.org/"><strong>Mermaid</strong></a>图表功能</td>
<td>实际使用过程中发现部分图表无法展示</td>
</tr>
<tr>
<td><a href="https://github.com/gitbook-plugin-fox/gitbook-plugin-flowchart-fox"><strong>gitbook-plugin-flowchart-fox</strong></a></td>
<td>用于支持<a href="https://flowchart.js.org/"><strong>flowchart</strong></a>图表</td>
<td>实际使用过程中发现该插件bug较多，在组件过多时会出现样式混乱</td>
</tr>
<tr>
<td><a href="https://github.com/codeclou/gitbook-plugin-advanced-emoji"><strong>gitbook-plugin-advanced-emoji</strong></a></td>
<td>用于展示<a href="https://getemoji.com/"><strong>Emoji</strong></a>表情</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/csbun/gitbook-plugin-chart#readme"><strong>gitbook-plugin-chart</strong></a></td>
<td>利用<a href="http://c3js.org/"><strong>C3.js</strong></a>或<a href="http://www.highcharts.com/"><strong>Highcharts</strong></a>来展示图表</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/somax/gitbook-plugin-popup"><strong>gitbook-plugin-popup</strong></a></td>
<td>在新窗口中打开图片</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/artalar/gitbook-plugin-accordion/"><strong>gitbook-plugin-accordion</strong></a></td>
<td>手风琴插件，用于展开或折叠相关内容</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/GitbookIO/plugin-katex"><strong>plugin-katex</strong></a></td>
<td>支持基于<a href="https://katex.org/"><strong>KaTeX</strong></a>的数学公式展示</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/gitbook-plugins/gitbook-plugin-search-pro"><strong>gitbook-plugin-search-pro</strong></a></td>
<td>支持中文搜索的插件</td>
<td>需要在<code>book.js</code>中通过 <code>-search</code>的方式屏蔽默认的搜索插件<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></td>
</tr>
<tr>
<td><a href="https://github.com/gonjay/gitbook-plugin-hide-element"><strong>gitbook-plugin-hide-element</strong></a></td>
<td>隐藏特定元素</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/ColinCollins/gitbook-plugin-chapter-fold"><strong>gitbook-plugin-chapter-fold</strong></a></td>
<td>页面上方的导航目录折叠</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/davidmogar/gitbook-plugin-code"><strong>gitbook-plugin-code</strong></a></td>
<td>给代码块添加行号与复制按钮</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/yoshidax/gitbook-plugin-splitter"><strong>gitbook-plugin-splitter</strong></a></td>
<td>页面左侧的侧边栏可动态调节</td>
<td>该插件与<code>xmind</code>插件一并使用时会导致后者无法正常使用</td>
</tr>
<tr>
<td><a href="https://github.com/cjdbarlow/gitbook-plugin-expandable-chapters-small"><strong>gitbook-plugin-expandable-chapters-small</strong></a></td>
<td>页面右侧的目录可展开或收缩</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/FastGitORG/gitbook-plugin-tbfed-pagefooter"><strong>gitbook-plugin-tbfed-pagefooter</strong></a></td>
<td>页面显示定制化的页脚信息</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/thomas88100/gitbook-plugin-ancre-navigation"><strong>gitbook-plugin-ancre-navigation</strong></a></td>
<td>页内导航回到顶部</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/GitbookIO/plugin-sharing"><strong>gitbook-plugin-sharing</strong></a></td>
<td>将特定页面分享到其它平台的按钮插件</td>
<td>需要在<code>book.js</code>中通过 <code>-sharing</code>的方式屏蔽默认的分享插件</td>
</tr>
<tr>
<td><a href="https://plugins.gitbook.com/plugin/theme-comscore"><strong>gitbook-plugin-theme-comscore</strong></a></td>
<td><code>GitBook</code>彩色主题</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/menduo/gitbook-plugin-favicon"><strong>gitbook-plugin-favicon</strong></a></td>
<td>添加favicon图标</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/fzankl/gitbook-plugin-flexible-alerts"><strong>gitbook-plugin-flexible-alerts</strong></a></td>
<td>自定义的提示说明样式</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="自定义插件">自定义插件</h2>
<p>已有的插件太老旧，自己<code>fork</code>代码后对它们进行了更新，项目位于<a href="https://github.com/gitbook-plugin-fox"><strong>gitbook-plugin-fox</strong></a>，目前包含如下插件：</p>
<ul>
<li>
<p><a href="https://github.com/gitbook-plugin-fox/gitbook-plugin-mermaid-fox"><strong>gitbook-plugin-mermaid-fox</strong></a>，<code>GitBook</code>中支持新版的<a href="https://flowchart.js.org/"><strong>flowchart.js</strong></a>图表，展示效果如下</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-flowchart-chart-display.png" alt="GitBook中展示Flowchart图表" title="GitBook中展示Flowchart图表"></p>
</li>
<li>
<p><a href="https://github.com/gitbook-plugin-fox/gitbook-plugin-mermaid-fox"><strong>gitbook-plugin-mermaid-fox</strong></a>，<code>GitBook</code>中支持新版的<a href="https://mermaid.js.org/"><strong>Mermaid</strong></a>图表，展示效果如下</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-mermaid-chart-display.png" alt="GitBook中展示Mermaid图表" title="GitBook中展示Mermaid图表"></p>
</li>
<li>
<p><a href="https://github.com/gitbook-plugin-fox/gitbook-plugin-prism-codetab-fox"><strong>gitbook-plugin-prism-codetab-fox</strong></a>，将<a href="https://github.com/gaearon/gitbook-plugin-prism"><strong>gitbook-plugin-prism</strong></a>与<a href="https://github.com/GitbookIO/plugin-codetabs"><strong>gitbook-plugin-codetabs</strong></a>这两个插件整合为一个插件，在实现代码高亮的同时还能对代码进行分组，展示效果如下：</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-codetab-fox-display.png" alt="GitBook中展示代码分组" title="GitBook中展示代码分组"></p>
</li>
</ul>
<h1 id="其它设置">其它设置</h1>
<h2 id="中文汉化">中文汉化</h2>
<p><code>GitBook</code>中的默认语言为英文，如下图所示，某些提示信息以英文展示，不方便使用</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-default-en-language.png" alt="GitBook默认英文展示" title="GitBook默认英文展示"></p>
<p>可通过在<code>book.js</code>中添加<code>language:'zh-hans'</code>来将默认语言修改为中文，修改后的显示效果如下：</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-set-zh-language.png" alt="GitBook切换为中文显示" title="GitBook切换为中文显示"></p>
<h2 id="自定义目录">自定义目录</h2>
<p>如下所示<code>GitBook</code>中默认生成的菜单为<code>Introduction</code>，不太直观，可根据实际需求动态修改(对于菜单目录的生成可参考<a href="#%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E7%9B%AE%E5%BD%95"><strong>自动生成目录</strong></a>实现)</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-default-menu.png" alt="GitBook默认菜单展示" title="GitBook默认菜单展示"></p>
<p>将默认目录从</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="k">*</span> [<span class="nt">Introduction</span>](<span class="na">README.md</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>修改为</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="k">*</span> [<span class="nt">概览</span>](<span class="na">README.md</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>之后的展示效果类似如下</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-custom-menu.png" alt="GitBook自定义菜单展示" title="GitBook自定义菜单展示"></p>
<h2 id="自定义样式">自定义样式</h2>
<p>若<code>GitBook</code>中的样式不满足我们的需求，可通过添加自定义<code>CSS</code>文件进行定制，实际使用中发现该文件必须叫做<code>website.css</code>且需位于生成的静态文件目录下才生效。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;styles&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;website&#34;</span><span class="p">:</span> <span class="s2">&#34;./styles/website.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="使用展示">使用展示</h1>
<p>可通过<code>Nginx</code>对应端口访问相应的<code>GitBook</code>页面，个人项目中的界面类似如下，供参考</p>
<p><img src="/blog_img/gitbook/using-docker-to-build-gitbook-with-gitlab-runner/gitbook-web-page-view.png" alt="GitBook页面浏览" title="GitBook页面浏览"></p>
<h1 id="文件脚本">文件&amp;脚本</h1>
<h2 id="dockerfile脚本">Dockerfile脚本</h2>
<p>用于构建同时包含<code>GitLab Runner</code>与<code>GitBook</code>的容器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> gitlab/gitlab-runner:v15.5.2</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 更改为公司内部的镜像源</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> rm -rf /etc/apt/sources.list <span class="o">&amp;&amp;</span> touch /etc/apt/sources.list<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;deb [trusted=yes] https://mirrors.xxx.com/repository/Debian/ bullseye main non-free contrib&#39;</span> &gt;&gt; /etc/apt/sources.list<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;deb-src [trusted=yes] https://mirrors.xxx.com/repository/Debian/ bullseye main non-free contrib&#39;</span> &gt;&gt; /etc/apt/sources.list<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;deb [trusted=yes] https://mirrors.xxx.com/repository/Debian/ bullseye-updates main non-free contrib&#39;</span> &gt;&gt; /etc/apt/sources.list<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;deb-src [trusted=yes] https://mirrors.xxx.com/repository/Debian/ bullseye-updates main non-free contrib&#39;</span> &gt;&gt; /etc/apt/sources.list<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;deb [trusted=yes] https://mirrors.xxx.com/repository/Debian/ bullseye-backports main non-free contrib&#39;</span> &gt;&gt; /etc/apt/sources.list<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;deb-src [trusted=yes] https://mirrors.xxx.com/repository/Debian/ bullseye-backports main non-free contrib&#39;</span> &gt;&gt; /etc/apt/sources.list<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 安装nodejs</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> apt-get update -y<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> apt-get install nodejs npm -y<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> npm cache clean --force<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> npm config <span class="nb">set</span> registry https://mirrors.xxx.com/repository/NPM/<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> npm install -g gitbook-cli@2.1.2<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> mkdir -p /usr/local/gitbook/data<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> mkdir -p /usr/local/gitbook/tmp/docs<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> chown -R gitlab-runner:gitlab-runner /usr/local/gitbook/tmp<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> book.js /usr/local/gitbook/tmp/book.js<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> custom.css /usr/local/gitbook/tmp/custom.css<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> favicon.ico /usr/local/gitbook/tmp/favicon.ico<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> auto_generate_summary.sh /usr/local/gitbook/auto_generate_summary.sh<span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="docker启停脚本">docker启停脚本</h2>
<p><code>docker-compose.yml</code>用于启动<code>GitLab Runner</code>与<code>Nginx</code>容器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">gitbook</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gitbook_custom:v1.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="l">$PWD/data:/usr/local/gitbook/data:rw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">gitbook-custom</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">nginx</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx:1.22</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="s2">&#34;3000:80&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="l">$PWD/data:/usr/share/nginx/html</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">gitbook-nginx</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="自动构建脚本">自动构建脚本</h2>
<p><code>.gitlab-ci.yml</code>是<code>GitLab Runner</code>构建时使用的文件，此文件规定了构建过程中要具体执行的步骤，只有此文件必须存在于目标文档对应的<code>GitLab</code>仓库，用于每次修改文档时触发自动构建</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">variables</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># 是否自动生成目录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">AUTO_SUMMARY</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># 定义ci/cd 执行build流程</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">stages</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># build阶段执行的操作命令 </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tags</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">xxx-doc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">echo &#34;======== start build ========&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">rm -rf /usr/local/gitbook/tmp/docs/*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cp -r * /usr/local/gitbook/tmp/docs/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">mkdir -p /usr/local/gitbook/tmp/docs/styles</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cd /usr/local/gitbook/tmp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cp custom.css  /usr/local/gitbook/tmp/docs/styles/website.css</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">bash /usr/local/gitbook/auto_generate_summary.sh $PWD</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">gitbook build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">rm -rf /usr/local/gitbook/data/*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cp -r /usr/local/gitbook/tmp/_book/*  /usr/local/gitbook/data/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cp -rf /usr/local/gitbook/tmp/favicon.ico  /usr/local/gitbook/data/gitbook/images/favicon.ico</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="自动注册脚本">自动注册脚本</h2>
<p><code>gitlab_runner_config_init.sh</code>用于注册<code>GitLab Runner</code>同时检测<code>GitBook</code>是否存在</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#更新文件权限</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">FOLDER</span><span class="o">=</span><span class="s2">&#34;/usr/local/gitbook/data&#34;</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it gitbook-custom bash -c <span class="s2">&#34;chown -R gitlab-runner:gitlab-runner </span><span class="nv">$FOLDER</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;===================完成</span><span class="nv">$FOLDER数据目录权限修改</span><span class="s2">=====================&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 删除gitlab runner</span>
</span></span><span class="line"><span class="cl"><span class="nv">GITLAB_URL</span><span class="o">=</span><span class="s1">&#39;http://aeectss.xxx.local:1800/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;===================开始删除旧的gitlab runner=====================&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">PRIVATE_TOKEN</span><span class="o">=</span><span class="s1">&#39;5JZxxYzapBB_zfze5c2_&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">PROJECT_ID</span><span class="o">=</span><span class="m">57</span>
</span></span><span class="line"><span class="cl"><span class="nv">ids</span><span class="o">=</span><span class="k">$(</span>curl --header <span class="s2">&#34;PRIVATE-TOKEN:</span><span class="si">${</span><span class="nv">PRIVATE_TOKEN</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">GITLAB_URL</span><span class="si">}</span><span class="s2">/api/v4/runners&#34;</span>  <span class="p">|</span>jq -r <span class="s1">&#39;.[]|&#34;\(.id)&#34;&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> id in <span class="nv">$ids</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">eval</span> <span class="s2">&#34;curl --request DELETE --header &#39;PRIVATE-TOKEN:</span><span class="si">${</span><span class="nv">PRIVATE_TOKEN</span><span class="si">}</span><span class="s2">&#39; &#39;</span><span class="si">${</span><span class="nv">GITLAB_URL</span><span class="si">}</span><span class="s2">/api/v4/runners/</span><span class="si">${</span><span class="nv">id</span><span class="si">}</span><span class="s2">&#39;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">printf</span> <span class="s2">&#34;\033[32m=====================删除id为</span><span class="si">${</span><span class="nv">id</span><span class="si">}</span><span class="s2">的runner======================\033[0m\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 注册gitlab runner</span>
</span></span><span class="line"><span class="cl"><span class="nv">CUR_DATE</span><span class="o">=</span><span class="k">$(</span>date <span class="s2">&#34;+%Y-%m-%d %H:%M:%S&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">TOKEN</span><span class="o">=</span><span class="s1">&#39;M9VwuFfu9E42mb5QRx7M&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">TAG_LIST</span><span class="o">=</span><span class="s1">&#39;xxxxx-doc&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">DESC</span><span class="o">=</span><span class="s1">&#39;xxxxx文档撰写&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;===================开始注册gitlab runner=====================&#39;</span>
</span></span><span class="line"><span class="cl">sudo docker <span class="nb">exec</span> -it gitbook-custom <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>gitlab-runner register --non-interactive <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--url <span class="s2">&#34;</span><span class="si">${</span><span class="nv">GITLAB_URL</span><span class="si">}</span><span class="s2">&#34;</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--registration-token <span class="s2">&#34;</span><span class="si">${</span><span class="nv">TOKEN</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>       --executor <span class="s2">&#34;shell&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>       --tag-list <span class="s2">&#34;</span><span class="si">${</span><span class="nv">TAG_LIST</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--description <span class="s2">&#34;</span><span class="si">${</span><span class="nv">DESC</span><span class="si">}</span><span class="s2"> -- 添加时间:</span><span class="si">${</span><span class="nv">CUR_DATE</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 安装gitbook</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;===================开始检查gitbook=====================&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">check</span><span class="o">=</span><span class="k">$(</span>docker <span class="nb">exec</span> -it --user gitlab-runner gitbook-custom gitbook ls<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="nv">$check</span> <span class="o">==</span> *<span class="s2">&#34;no versions installed&#34;</span>* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;gitbook在gitlab-runner用户下没有安装&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">command</span><span class="o">=</span><span class="s2">&#34;npm config set registry https://mirrors.xxx.com/repository/NPM/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">command</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">command</span><span class="si">}</span><span class="s2">;gitbook fetch&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">command</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">command</span><span class="si">}</span><span class="s2">;cd /usr/local/gitbook/tmp&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">command</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">command</span><span class="si">}</span><span class="s2">;npm install gitbook-plugin-mermaid-fox&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">command</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">command</span><span class="si">}</span><span class="s2">;gitbook install&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#command=&#34;${command};cp /usr/local/gitbook/tmp/node_modules/prismjs/components/prism-docker.js /usr/local/gitbook/tmp/node_modules/prismjs/components/prism-dockerfile.js&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">command</span><span class="o">=</span><span class="s2">&#34;docker exec -it --user gitlab-runner gitbook-custom bash -c &#39;</span><span class="nv">$command</span><span class="s2">&#39;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;=========================要执行的命令=======================&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">printf</span> <span class="s2">&#34;\033[32m</span><span class="si">${</span><span class="nv">command</span><span class="si">}</span><span class="s2">\033[0m\n&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;============================================================&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">eval</span> <span class="nv">$command</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="nb">printf</span> <span class="s2">&#34;\033[32mGitbook已经安装，相关检查结果如下:\033[0m\n&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$check</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">printf</span> <span class="s2">&#34;\033[32m===================gitlab runner初始化完毕!=====================\033[0m\n&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="自动生成目录">自动生成目录</h2>
<p><code>auto_generate_summary.sh</code>用于自动生成目录，<code>GitBook</code>左侧的目录树依赖于此脚本的生成结果，此文件会在<code>GitLab Runner</code>构建阶段执行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># 先清空文件</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;  docs/SUMMARY.md
</span></span><span class="line"><span class="cl"><span class="c1"># 子文件夹读取的递归函数</span>
</span></span><span class="line"><span class="cl">dirReader<span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># $1 文件绝对路径</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># $2 章节名称</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># $3 缩进</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 循环处理该文件夹下的文件</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> item in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>/*
</span></span><span class="line"><span class="cl">    <span class="k">do</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 判断是否是文件夹且不是图片文件夹</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[</span> -d <span class="s2">&#34;</span><span class="nv">$item</span><span class="s2">&#34;</span> <span class="o">]</span>  <span class="o">&amp;&amp;</span>  ! <span class="o">[[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">item</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span>~ assets$ <span class="o">]]</span>
</span></span><span class="line"><span class="cl">        <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 判断该文件夹是否存在README.md文件</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">[</span> ! -f <span class="s2">&#34;</span><span class="nv">$item</span><span class="s2">/README.md&#34;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">then</span> 
</span></span><span class="line"><span class="cl">                <span class="c1"># 如果没有就创建README.md</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt; <span class="s2">&#34;</span><span class="nv">$item</span><span class="s2">/README.md&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">fi</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 获取文件名称</span>
</span></span><span class="line"><span class="cl">            <span class="nv">beginPos</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${#</span><span class="nv">1</span><span class="si">}</span> + 1<span class="sb">`</span>
</span></span><span class="line"><span class="cl">            <span class="nv">endPos</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${#</span><span class="nv">item</span><span class="si">}</span> - <span class="si">${#</span><span class="nv">1</span><span class="si">}</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">            <span class="nv">dirName</span><span class="o">=</span><span class="si">${</span><span class="nv">item</span><span class="p">:</span><span class="nv">$beginPos</span><span class="p">:</span><span class="nv">$endPos</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">            <span class="nb">echo</span> <span class="si">${</span><span class="nv">item</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 写入目录文件</span>
</span></span><span class="line"><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$3</span><span class="s2">+ [</span><span class="nv">$dirName</span><span class="s2">](</span><span class="nv">$2</span><span class="s2">/</span><span class="nv">$dirName</span><span class="s2">/README.md)&#34;</span> &gt;&gt; docs/SUMMARY.md
</span></span><span class="line"><span class="cl">            <span class="c1"># 递归处理该文件夹</span>
</span></span><span class="line"><span class="cl">            dirReader <span class="s2">&#34;</span><span class="nv">$item</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$2</span><span class="s2">/</span><span class="nv">$dirName</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$3</span><span class="s2">  &#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 判断该文件是否是.md结尾 并且不是README.md</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$item</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">item</span><span class="p">##*.</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span> <span class="o">]</span> 
</span></span><span class="line"><span class="cl">        <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="nv">beginPos</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${#</span><span class="nv">1</span><span class="si">}</span> + 1<span class="sb">`</span>
</span></span><span class="line"><span class="cl">            <span class="nv">endPos</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${#</span><span class="nv">item</span><span class="si">}</span> - <span class="si">${#</span><span class="nv">1</span><span class="si">}</span> - 4<span class="sb">`</span>
</span></span><span class="line"><span class="cl">            <span class="nv">dirName</span><span class="o">=</span><span class="si">${</span><span class="nv">item</span><span class="p">:</span><span class="nv">$beginPos</span><span class="p">:</span><span class="nv">$endPos</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 写入目录文件</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$dirName</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s1">&#39;README&#39;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">then</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="si">${</span><span class="nv">item</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$3</span><span class="s2">+ [</span><span class="nv">$dirName</span><span class="s2">](</span><span class="nv">$2</span><span class="s2">/</span><span class="nv">$dirName</span><span class="s2">.md)&#34;</span> &gt;&gt; docs/SUMMARY.md
</span></span><span class="line"><span class="cl">            <span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 读取当前路径</span>
</span></span><span class="line"><span class="cl"><span class="nv">dirs</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">/docs/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;- [主页](README.md)&#34;</span> &gt;  docs/SUMMARY.md
</span></span><span class="line"><span class="cl"><span class="c1"># 循环处理该文件夹下的文件dir</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> dir in docs/*
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 截取掉dir路径名称里的 docs/</span>
</span></span><span class="line"><span class="cl">    <span class="nv">startPos</span><span class="o">=</span><span class="s1">&#39;5&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">length</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${#</span><span class="nv">dir</span><span class="si">}</span> - 5<span class="sb">`</span>
</span></span><span class="line"><span class="cl">    <span class="nv">dir</span><span class="o">=</span><span class="si">${</span><span class="nv">dir</span><span class="p">:</span><span class="nv">$startPos</span><span class="p">:</span><span class="nv">$length</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 判断是否是文件夹且不是图片文件夹</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dirs</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> ! <span class="o">[[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span>~ assets$ <span class="o">]]</span> <span class="o">&amp;&amp;</span> ! <span class="o">[[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span>~ styles$ <span class="o">]]</span> 
</span></span><span class="line"><span class="cl">    <span class="k">then</span> 
</span></span><span class="line"><span class="cl">        <span class="c1"># 判断该文件夹是否存在README.md文件</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[</span> ! -f <span class="s2">&#34;</span><span class="nv">$dirs</span><span class="s2">/</span><span class="nv">$dir</span><span class="s2">/README.md&#34;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">then</span> 
</span></span><span class="line"><span class="cl">        	<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt; <span class="s2">&#34;</span><span class="nv">$dirs</span><span class="s2">/</span><span class="nv">$dir</span><span class="s2">/README.md&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 写入目录文件</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;+ [</span><span class="nv">$dir</span><span class="s2">](</span><span class="nv">$dir</span><span class="s2">/README.md)&#34;</span> &gt;&gt; docs/SUMMARY.md
</span></span><span class="line"><span class="cl">        <span class="c1"># 处理文件夹内部的文件</span>
</span></span><span class="line"><span class="cl">        dirReader <span class="s2">&#34;</span><span class="nv">$dirs$dir</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$dir</span><span class="s2">&#34;</span> <span class="s2">&#34;  &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 判断该文件是否是.md结尾 并且不是SUMMARY.md 和 README.md</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span>  <span class="o">[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="p">##*.</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;SUMMARY.md&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s1">&#39;README.md&#39;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 写入目录文件</span>
</span></span><span class="line"><span class="cl">    	<span class="nb">echo</span> <span class="s2">&#34;+ [</span><span class="nv">$dir</span><span class="s2">](</span><span class="nv">$dir</span><span class="s2">)&#34;</span> &gt;&gt; docs/SUMMARY.md
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="自定义样式-1">自定义样式</h2>
<p><code>custom.css</code>是自定义样式文件，当对<code>GitBook</code>的某些样式不满意时，可用自定义<code>CSS</code>文件来覆盖</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="p">.</span><span class="nc">book</span> <span class="p">.</span><span class="nc">book-body</span> <span class="p">.</span><span class="nc">page-wrapper</span> <span class="p">.</span><span class="nc">page-inner</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">max-width</span><span class="p">:</span> <span class="mi">1200</span><span class="kt">px</span> <span class="cp">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">markdown-section</span> <span class="nt">img</span><span class="p">:</span><span class="nd">not</span><span class="o">(</span><span class="p">.</span><span class="nc">emoji</span><span class="o">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">max-width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">dashed</span> <span class="mh">#a9a4a4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">table</span> <span class="o">&gt;</span> <span class="nt">thead</span> <span class="o">&gt;</span> <span class="nt">tr</span> <span class="o">&gt;</span> <span class="nt">th</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">text-align</span><span class="p">:</span><span class="kc">center</span> <span class="cp">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">markdown-section</span> <span class="nt">code</span><span class="p">:</span><span class="nd">not</span><span class="o">([</span><span class="nt">class</span><span class="o">^=</span><span class="s2">&#34;lang-&#34;</span><span class="o">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">font-size</span><span class="p">:</span> <span class="mf">.85</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">color</span><span class="p">:</span> <span class="mh">#c7254e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">border-radius</span><span class="p">:</span> <span class="mi">4</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">small</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">font-size</span><span class="p">:</span> <span class="mi">80</span><span class="kt">%</span> <span class="cp">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">section</span>  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">width</span><span class="p">:</span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nt">h1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">color</span><span class="p">:</span> <span class="mh">#2674BA</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nt">h2</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">color</span><span class="p">:</span> <span class="mh">#0099CC</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nt">h3</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">color</span><span class="p">:</span> <span class="mh">#F77A0B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nt">h4</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">color</span><span class="p">:</span> <span class="mh">#662D91</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nt">h5</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">color</span><span class="p">:</span> <span class="mh">#444444</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nt">th</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">background-color</span><span class="p">:</span> <span class="mh">#2674BA</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">color</span><span class="p">:</span> <span class="kc">white</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gitbook配置文件">GitBook配置文件</h2>
<p><code>book.js</code>是<code>GitBook</code>的配置文件，包含全局配置与各种插件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// markdown文档所在路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">root</span><span class="o">:</span> <span class="s1">&#39;./docs&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 项目标题
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;xxxxx平台文档&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 版本
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">gitbook</span><span class="o">:</span> <span class="s1">&#39;3.2.3&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">language</span><span class="o">:</span> <span class="s1">&#39;zh-hans&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 插件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;-highlight&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;prism-codetab-fox&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;advanced-emoji&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;mermaid-fox&#39;</span><span class="p">,</span> <span class="c1">// 图表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;graph&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;flowchart-fox&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;chart&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;popup&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;accordion&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;katex&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;-search&#39;</span><span class="p">,</span> <span class="c1">//搜索
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;search-pro&#39;</span><span class="p">,</span> <span class="c1">//中文搜索
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;hide-element&#39;</span><span class="p">,</span> <span class="c1">//元素隐藏
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;-lunr&#39;</span><span class="p">,</span> <span class="c1">//索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;chapter-fold&#39;</span><span class="p">,</span> <span class="c1">//导航目录折叠
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="c1">//代码复制按钮
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;splitter&#39;</span><span class="p">,</span> <span class="c1">//侧边栏宽度可调节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;expandable-chapters-small&#39;</span><span class="p">,</span> <span class="c1">//目录收起
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;tbfed-pagefooter&#39;</span><span class="p">,</span> <span class="c1">//页面添加页脚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;ancre-navigation&#39;</span><span class="p">,</span> <span class="c1">//页内导航回到顶部
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;-sharing&#39;</span><span class="p">,</span> <span class="s1">&#39;sharing-plus&#39;</span><span class="p">,</span> <span class="c1">//分享链接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;theme-comscore&#39;</span><span class="p">,</span> <span class="c1">//主题
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;favicon&#39;</span><span class="p">,</span> <span class="c1">//图标
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s1">&#39;flexible-alerts&#39;</span> <span class="c1">// 警告
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 插件配置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">pluginsConfig</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;prism&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;css&#39;</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;prismjs/themes/prism-solarizedlight.css&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;lang&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;dockerfile&#34;</span><span class="o">:</span> <span class="s2">&#34;docker&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ignore&#34;</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;mermaid&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;eval-js&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;hide-element&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;elements&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;.gitbook-link&#39;</span><span class="p">]</span> <span class="c1">//需要隐藏的元素，可以通过浏览网页找到该class
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;tbfed-pagefooter&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;copyright&#39;</span><span class="o">:</span> <span class="s1">&#39;Copyright &amp;copy xxx.com 2023-2033&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;modify_label&#39;</span><span class="o">:</span> <span class="s1">&#39;修订时间：&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;modify_format&#39;</span><span class="o">:</span> <span class="s1">&#39;YYYY-MM-DD HH:mm:ss&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;sharing&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;all&#39;</span><span class="o">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;chart&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span><span class="o">:</span> <span class="s2">&#34;c3&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;chapter-fold&#34;</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;favicon&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;shortcut&#34;</span><span class="o">:</span> <span class="s2">&#34;/favicon.ico&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;bookmark&#34;</span><span class="o">:</span> <span class="s2">&#34;/favicon.ico&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;flowchart&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;arrow-end&#34;</span><span class="o">:</span> <span class="s2">&#34;block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;element-color&#34;</span><span class="o">:</span> <span class="s2">&#34;black&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;white&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;flowstate&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;approved&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#58C4A3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-size&#34;</span><span class="o">:</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;current&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#008080&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-color&#34;</span><span class="o">:</span> <span class="s2">&#34;white&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-weight&#34;</span><span class="o">:</span> <span class="s2">&#34;bold&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;future&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#8A624A&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;success&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#0B6623&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;invalid&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#6c5696&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;past&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#CCCCCC&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-size&#34;</span><span class="o">:</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;select&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#E1AD01&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-size&#34;</span><span class="o">:</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;rejected&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#C45879&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-size&#34;</span><span class="o">:</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;request&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#569656&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;yellowgreen&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;yellowgreen&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;failed&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#800020&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;font-color&#34;</span><span class="o">:</span> <span class="s2">&#34;black&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;font-size&#34;</span><span class="o">:</span> <span class="mi">14</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;line-color&#34;</span><span class="o">:</span> <span class="s2">&#34;black&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;line-length&#34;</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;line-width&#34;</span><span class="o">:</span> <span class="mf">1.3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;scale&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;symbols&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;end&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;class&#34;</span><span class="o">:</span> <span class="s2">&#34;end-element&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-color&#34;</span><span class="o">:</span> <span class="s2">&#34;white&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-weight&#34;</span><span class="o">:</span> <span class="s2">&#34;bold&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;start&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;fill&#34;</span><span class="o">:</span> <span class="s2">&#34;#8c2106&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-color&#34;</span><span class="o">:</span> <span class="s2">&#34;white&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;font-weight&#34;</span><span class="o">:</span> <span class="s2">&#34;bold&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;text-margin&#34;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;width&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;x&#34;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;y&#34;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;yes-text&#34;</span><span class="o">:</span> <span class="s2">&#34;是&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;no-text&#34;</span><span class="o">:</span> <span class="s2">&#34;否&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">variables</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;styles&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;website&#34;</span><span class="o">:</span> <span class="s2">&#34;./styles/website.css&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>可根据实际要求通过<code>-lunr</code>来屏蔽对应的索引插件&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/gitbook/">gitbook</a>
          <a href="/tags/docker/">docker</a>
          <a href="/tags/gitlab-runner/">gitlab-runner</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/devops/using-ssh-to-deploy-in-remote-server-in-jenkins/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">利用SSH实现在Jekins中给远程服务器部署项目</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/nacos/spring-boot-cloud-version-not-compatible-due-to-nacos/">
            <span class="next-text nav-default">由于Nacos导致的Spring Boot与Spring Cloud版本不兼容原因分析</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://giscus.app/client.js"
            data-repo="lucumt/ghblog"
            data-repo-id="MDEwOlJlcG9zaXRvcnk0MTQ3MDEzOA=="
            data-category="General"
            data-category-id="DIC_kwDOAnjIus4CRN6c"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="top"
            data-theme="light"
            data-lang="en"
            data-loading="lazy"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/giscus/giscus">comments powered by giscus.</a></noscript>

      </div>
    </main>
	

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:cumtlu@126.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/users/3176419" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://www.linkedin.com/in/%E8%BF%90%E5%BC%BA-%E5%8D%A2-50a08bb5/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://github.com/lucumt" class="iconfont icon-github" title="github"></a>
  <a href="https://lucumt.info/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2016 - 
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>Rosen Lu</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top" title="回到顶部">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.6.4.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>


<script src="/lib/flowchartDiagrams/raphael-2.2.7.min.js"></script>
    <script src="/lib/flowchartDiagrams/flowchart-1.8.0.min.js"></script><script>
	   
	
	<!-- below is newly added code -->
	let flowPageOptions = "{ 'x': 0, 'y': 10, 'width':1, 'yes-text': 'yes', 'no-text': 'no', 'line-width': 1.3, 'line-length': 30, 'text-margin': 10, 'font-size': 15, 'font-color': 'black', 'line-color': 'black', 'element-color': 'black', 'fill': 'white', 'arrow-end': 'block', 'font-weight': 'bold', 'font-color': 'white', 'scale': 0.8, 'symbols': { }, 'flowstate': { 'approved': { 'fill': '#58C4A3', 'font-size': 12 }, 'current': { 'fill': '#008080', 'font-color': 'white', 'font-weight': 'bold' }, 'future': { 'fill': '#8A624A' }, 'success': { 'fill': '#0B6623', 'font-color': 'white', 'font-weight': 'bold' }, 'invalid': { 'fill': '#6c5696' }, 'past': { 'fill': '#CCCCCC', 'font-size': 12 }, 'select': { 'fill': '#E1AD01', 'font-size': 12, 'yes-text': '是', 'no-text': '否' }, 'rejected': { 'fill': '#C45879', 'font-size': 12 }, 'request': { 'fill': '#569656' }, 'yellowgreen':{ 'fill': 'yellowgreen' }, 'failed':{ 'fill': '#800020' }, 'approved': {'fill': 'peru'} } }";
	let flowSiteOptions = "";
	flowPageOptions = !!flowPageOptions ? flowPageOptions : "{}"
	flowSiteOptions = !!flowSiteOptions ? flowSiteOptions : "{}"
	
	flowPageOptions = eval("(" + flowPageOptions + ")")
	flowSiteOptions = eval("(" + flowSiteOptions + ")")
	
	let flowOptions = {...flowSiteOptions, ...flowPageOptions}; 
	$("[id^=flow_]").flowChart(flowOptions);
	</script>









<script type="text/javascript" src="/js/main.min.191509a5c8442abdb6eb5020a332fd59bdd83a7e78a2d2241108df9113504292.js"></script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7546563545653680"
            crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-75123653-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-75123653-1');
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-3S3FFW5PH3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3S3FFW5PH3');
</script><script id="baidu_analytics">
	  var _hmt = _hmt || [];
	  (function() {
		if (window.location.hostname === 'localhost') return;
		var hm = document.createElement("script"); hm.async = true;
		hm.src = "https://hm.baidu.com/hm.js?cabc0a71f63da092412d82d1aefe7d1c";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hm, s);
	  })();
	</script>


	<script id="baidu_push">
	  (function(){
		if (window.location.hostname === 'localhost') return;
		var bp = document.createElement('script'); bp.async = true;
		var curProtocol = window.location.protocol.split(':')[0];
		if (curProtocol === 'https') {
		  bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
		}
		else {
		  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
		}
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(bp, s);
	  })();
	</script>


<script>
  function createCopyButton(highlightDiv) {
    const div = document.createElement("div");
    div.className = "copy-code";
    div.innerText = "Copy";
    div.addEventListener("click", () =>
      copyCodeToClipboard(div, highlightDiv)
    );
    addCopyButtonToDom(div, highlightDiv);
  }

  async function copyCodeToClipboard(button, highlightDiv) {
    const codeToCopy = highlightDiv.querySelector(":last-child > .chroma > code")
      .innerText;
    await navigator.clipboard.writeText(codeToCopy);
    button.blur();
    button.innerText = "Copied!";
    setTimeout(() => button.innerText = "Copy", 2000);
  }

  function addCopyButtonToDom(button, highlightDiv) {
    highlightDiv.insertBefore(button, highlightDiv.firstChild);
    const wrapper = document.createElement("div");
    wrapper.className = "highlight-wrapper";
    highlightDiv.parentNode.insertBefore(wrapper, highlightDiv);
    wrapper.appendChild(highlightDiv);
  }

  var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
  if(!isMobile){
     document.querySelectorAll(".highlight").forEach((highlightDiv) => createCopyButton(highlightDiv));
  }
</script>  


</body>
</html>
